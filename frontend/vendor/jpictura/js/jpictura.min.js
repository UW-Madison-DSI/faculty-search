/*!
 * jPictura v1.2.3
 * https://github.com/anmarcek/jpictura.git
 *
 * Copyright (c) 2015-2016 Anton Marček
 * Released under the MIT license
 *
 * Date: 2016-08-11T14:33:12.122Z
 */
/*!
 * jPictura Core v0.1.4
 * https://github.com/anmarcek/jpictura-core.git
 *
 * Copyright (c) 2015-2016 Anton Marček
 * Released under the MIT license
 *
 * Date: 2016-08-10T08:36:14.607Z
 */
var jpictura={core:{}};jpictura.core.debounce=function(t,e,i){var a;return function(){var n=this,o=arguments,r=function(){a=null,i||t.apply(n,o)},s=i&&!a;clearTimeout(a),a=setTimeout(r,e),s&&t.apply(n,o)}},jpictura.core.offWindowWidthResize=function(t){$(window).off("."+t)},jpictura.core.onWindowWidthResize=function(t,e){var i=$(window),a=i.width();i.on("resize."+t,function(){var t=i.width();a!==t&&(e(),a=t)})},jpictura.core.heightCalculator=function(t,e,i){function a(t){n(t),o(t),s()}function n(t){var e=0,i=f.layout.idealRowHeight,a=f.layout.maxWidthHeightRatio;u=t/((t-e)/i+a)}function o(t){var e=0,i=f.layout.idealRowHeight,a=f.layout.maxWidthHeightRatio;a*i>=t?(f.debug&&d("The max width/height ratio "+a+" is too big for row width "+t+"px."),c=t*a):c=t/((t+e)/i-a)}function r(t,e){var i,a,n=0;do i=g(t,h,!1,f),i>e?c=h:u=h,s(u,c),a=!1,i>e&&(a=!0),e-i>f.algorithm.epsilon&&(a=!0),++n>=f.algorithm.maxIterationCount&&(a=!1);while(a);return n>=f.algorithm.maxIterationCount&&f.debug&&d("Max "+n+" iterations reached. Current precision: "+(e-i)+"."),h}function s(){h=(u+c)/2}function l(t,e,i){t=Math.floor(t);var a;do a=g(e,t,!0,f);while(i>a&&t++);return t}var u,c,h,d=e,g=t,f=i;this.getHeight=function(t,e){if(0===t.length)return 0;a(e);var i=r(t,e);return i=l(i,t,e)}},function(t){function e(t,e){t.addClass(e.classes.container),t.toggleClass("stretch-images",e.layout.stretchImages),t.toggleClass("center-images",e.layout.centerImages),t.toggleClass("disable-cropping-images",!e.layout.allowCropping),t.toggleClass("fade-in-items",e.effects.fadeInItems);var a=t.find(e.selectors.item);a.addClass(e.classes.item);var o=a.find(e.selectors.image);o.addClass(e.classes.image),i(t,a,e,n)}function i(t,e,i,n){i.waitForImages?a(t,e,i,n):n(t,e,i)}function a(e,i,a,n){function o(t,o){var s=o.width/o.height;P(t,s),++r===i.size()&&n(e,i,a)}var r=0;i.each(function(){var e=t(this),i=e.find(a.selectors.image),n=new Image;n.src=i.attr("src"),t(n).load(function(){o(e,n)})})}function n(t,e,i){var a=jpictura.core.debounce(function(){r(t,e,i)},i.responsive.debounce);o(a,t,i),a()}function o(t,e,i){jpictura.core.offWindowWidthResize($),i.responsive.enabled&&i.responsive.onWindowWidthResize&&jpictura.core.onWindowWidthResize($,t);var a=$+"-resize-interval",n=e.data(a);if(clearInterval(n),e.data(a,null),i.responsive.enabled&&i.responsive.onContainerWidthResize){var o=F(e);n=setInterval(function(){var i=F(e);i!==o&&(o=i,t())},i.responsive.containerResizeInterval),e.data(a,n)}}function r(t,e,i){s(t,0);var a,n=(new Date).getTime(),o=10,r=0,l=[];do{e.addClass(i.classes.invisible),e.addClass(i.classes.hidden);var c=F(t);l.push(c);var h=!1;if(l.length>=3){var d=l[l.length-3],g=l[l.length-2];d>g&&d===c&&(c=g,h=!0)}u(Math.floor(c),e,i);var f=F(t);if(l.push(f),a=!1,c!==f){var m=l[l.length-2];a=!h||m!==f}}while(a&&++r<=o);var p=(new Date).getTime();r>o&&i.debug?E("Max redraw tries of "+o+"reached. Gallery redraw failed."):i.debug&&E("Gallery redrawn in "+(p-n)+" milliseconds."),s(t,null)}function s(t,e){t.data(l(),e)}function l(){return $+"-redraw-progress"}function u(e,i,a){var n=[],o=e-2*a.layout.rowPadding,r=new a.heightCalculator(H,E,a);i.each(function(){var e=t(this);if(0===n.length)n.push(e);else{var i=n.slice(0);if(i.push(e),c(i,o,a)){var s=h(n,o,r,a),l=h(i,o,r,a),u=t.fn.jpictura.evaluate(s,a),g=t.fn.jpictura.evaluate(l,a);u>g?n.push(e):(d(n,o,s,!1,a),n=[],n.push(e))}else n.push(e)}});var s=c(n,o,a)||a.layout.justifyLastRow?h(n,o,r,a):a.layout.idealRowHeight;d(n,o,s,!0,a)}function c(t,e,i){for(var a=(t.length-1)*i.layout.itemSpacing,n=0;n<t.length;n++)a+=M(t[n],i.layout.idealRowHeight,i);return a>e}function h(t,e,i,a){var n=z(t,e,a);return i.getHeight(t,n)}function d(t,e,i,a,n){for(var o=H(t,i,!0,n),r=z(t,e,n),s={row:t,width:e,height:i,isLastRow:a,itemsSpaceWidth:r,itemsWidthDelta:o-r,unassignedItemsWidthDelta:o-r},l=g(t,n),u=0;u<l.length;u++)f(l[u],s,n)}function g(t,e){var i=t.slice(0);return i.sort(function(t,i){return S(i,!0,e)-S(t,!0,e)}),i}function f(t,e,i){var a=e.row,n=e.isLastRow,o=t===a[0],r=t===a[a.length-1],s=m(t,e,i),l=e.height,u=t.find(i.selectors.image);v(t,s,l),w(t,i),y(t,n,o,r,i),R(t,o,r,i),C(t,r,n,i),W(t,s,l,i),I(u,s,l,i)}function m(t,e,i){var a=M(t,e.height,i),n=p(a,e);return Math.floor(a)-n}function p(t,e){if(e.unassignedItemsWidthDelta<=0)return 0;var i=Math.ceil(t/e.itemsSpaceWidth*e.itemsWidthDelta);return e.unassignedItemsWidthDelta<i&&(i=e.unassignedItemsWidthDelta),e.unassignedItemsWidthDelta-=i,i}function v(t,e,i){t.width(e),t.height(i)}function w(t,e){t.removeClass(e.classes.invisible),t.removeClass(e.classes.hidden)}function y(t,e,i,a,n){t.toggleClass(n.classes.lastRow,e),t.toggleClass(n.classes.firstInRow,i),t.toggleClass(n.classes.lastInRow,a)}function R(t,e,i,a){var n={left:"",right:""};a.layout.applyRowPadding&&(n.left=(e?a.layout.rowPadding:0)+"px",n.right=(i?a.layout.rowPadding:0)+"px"),t.css("margin-left",n.left),t.css("margin-right",n.right)}function C(t,e,i,a){var n={right:"",bottom:""};a.layout.applyItemSpacing&&(n.right=(e?0:a.layout.itemSpacing)+"px",n.bottom=(i?0:a.layout.itemSpacing)+"px"),t.css("margin-right",n.right),t.css("margin-bottom",n.bottom)}function W(t,e,i,a){var n=S(t,!1,a)*i;t.toggleClass("stretch-by-height",n>=e),t.toggleClass("stretch-by-width",e>n);var o=b(n,e,a);t.toggleClass("cropped-if-stretched",o)}function I(t,e,i){t.toggleClass("horizontal-misfit",j(t,e)),t.toggleClass("vertical-misfit",x(t,i))}function b(t,e,i){return Math.abs(t-e)>i.layout.croppingEpsilon}function j(t,e){return Math.abs(t.width()-e)>1}function x(t,e){return Math.abs(t.height()-e)>1}function H(t,e,i,a){for(var n=0,o=0;o<t.length;o++){var r=M(t[o],e,a);i&&(r=Math.floor(r)),n+=r}return n}function z(t,e,i){return e-(t.length-1)*i.layout.itemSpacing}function M(t,e,i){return S(t,!0,i)*e}function S(t,e,i){var a=$+"-ratio",n=t.data(a);if(void 0===n&&(n=D(t,i),t.data(a,n)),e){if(n<=i.layout.minWidthHeightRatio)return i.layout.minWidthHeightRatio;if(n>=i.layout.maxWidthHeightRatio)return i.layout.maxWidthHeightRatio}return n}function D(t,e){var i=L(t,e),a=T(t,e);return i/a}function P(t,e){var i=$+"-ratio";t.data(i,e)}function L(t,e){var i=$+"-width",a=t.data(i);if(void 0===a){var n=t.find(e.selectors.image);a=n.prop("naturalWidth"),t.data(i,a)}return a}function T(t,e){var i=$+"-height",a=t.data(i);if(void 0===a){var n=t.find(e.selectors.image);a=n.prop("naturalHeight"),t.data(i,a)}return a}function F(t){return parseFloat(window.getComputedStyle(t[0],null).getPropertyValue("width"))}function E(t){window.console&&console.log(G+": "+t)}t.fn.jpictura=function(i){var a=t.extend(!0,{},t.fn.jpictura.defaults,i);return this.each(function(){e(t(this),a)}),this};var G="jPictura",$=G.toLowerCase();t.fn.jpictura.defaults={selectors:{item:".item",image:"img"},classes:{container:$,item:$+"-item",image:$+"-image",lastRow:$+"-last-row",firstInRow:$+"-first-in-row",lastInRow:$+"-last-in-row",invisible:$+"-invisible",hidden:$+"-hidden",offContentFlow:$+"-off-content-flow"},layout:{rowPadding:0,applyRowPadding:!0,itemSpacing:5,applyItemSpacing:!0,idealRowHeight:180,minWidthHeightRatio:1/3,maxWidthHeightRatio:3,stretchImages:!0,allowCropping:!0,croppingEpsilon:3,centerImages:!0,justifyLastRow:!1},effects:{fadeInItems:!1},responsive:{enabled:!0,onWindowWidthResize:!0,onContainerWidthResize:!0,containerResizeInterval:50,debounce:200},waitForImages:!0,heightCalculator:jpictura.core.heightCalculator,algorithm:{epsilon:.01,maxIterationCount:50},debug:!1},t.fn.jpictura.evaluate=function(t,e){return Math.abs(t-e.layout.idealRowHeight)}}(jQuery);